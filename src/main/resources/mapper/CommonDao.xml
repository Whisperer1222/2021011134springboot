<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.dao.CommonDao">
	<!-- 通用查询操作 getOption方法用于选择某个表中某一列的不为空且非空字符串的distinct值，可以根据level和parent参数进一步过滤 -->
	<select id="getOption" resultType="String" >
		SELECT distinct ${column} FROM ${table} 
			where ${column} is not null and ${column} !=''
			<if test = "level != null"> 
			and level=#{level} 
			</if>
			<if test = "parent != null"> 
			and parent=#{parent} 
			</if>
	</select>
	<!-- 根据选项获取跟随项 getFollowByOption方法用于根据给定的列和值选择表中的所有相关记录 -->
	<select id="getFollowByOption" resultType="map" >
		SELECT * FROM ${table} where ${column}=#{columnValue}
	</select>
	<!-- 更新操作 sh方法用于更新表中指定ID的记录的某个字段（在这个例子中是sfsh字段） -->
	<update id="sh">
		UPDATE ${table} set sfsh=#{sfsh} where id=#{id}
	</update>
	<!-- 提醒计数查询 remindCount方法用于根据不同的条件（包括日期格式）统计表中的记录数-->
	<select id="remindCount" resultType="int" >
		SELECT count(1) FROM ${table} 
			where 1=1 
			<if test = "type == 1 ">
				<if test = " remindstart != null ">
				     and ${column} &gt;= #{remindstart}
				</if>
				<if test = " remindend != null ">
				     and ${column} &lt;= #{remindend}
				</if>
			</if>
						<if test = "type == 2 ">
				<if test = " remindstart != null ">
				     and ${column} &gt;= str_to_date(#{remindstart},'%Y-%m-%d')
				</if>
				<if test = " remindend != null ">
				     and ${column} &lt;= str_to_date(#{remindend},'%Y-%m-%d')
				</if>
			</if>
							</select>
	<!-- 聚合函数查询 selectCal方法用于计算表中某一列的总和、最大值、最小值和平均值-->
	<select id="selectCal" resultType="map" >
		SELECT sum(${column}) sum,max(${column}) max,min(${column}) min,avg(${column}) avg FROM ${table}
	</select>
	<!-- 分组统计查询 selectGroup方法用于按某一列对表进行分组，并计算每组的记录数-->
	<select id="selectGroup" resultType="map" >
		SELECT ${column} , count(1) total FROM ${table} group by ${column}
	</select>
	<!-- 二维分组统计查询 selectValue方法用于按某一列（xColumn）对表进行分组，并计算另一列（yColumn）的总和-->
	<select id="selectValue" resultType="map" >
		SELECT ${xColumn}, sum(${yColumn}) total FROM ${table} group by ${xColumn}
	</select>
	
</mapper>